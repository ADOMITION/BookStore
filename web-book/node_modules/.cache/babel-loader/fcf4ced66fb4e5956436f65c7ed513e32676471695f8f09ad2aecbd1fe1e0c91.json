{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  data() {\n    return {\n      order: {\n        oid: this.$route.query.oid,\n        total: parseFloat(this.$route.query.total)\n      },\n      loading: false\n    };\n  },\n  methods: {\n    async handlePay() {\n      this.loading = true;\n      try {\n        const {\n          data\n        } = await this.$axios.post(this.$httpUrl + '/order/pay', {\n          oid: this.order.oid\n        });\n        if (data.code === 200) {\n          this.$router.push({\n            path: '/pay-result',\n            query: {\n              success: true,\n              oid: this.order.oid\n            }\n          });\n        }\n      } catch (error) {\n        // 新增库存不足的提示\n        if (error.response && error.response.data.msg.includes(\"库存不足\")) {\n          this.$message.error('部分商品库存不足，支付失败');\n        } else {\n          this.$message.error('支付失败');\n        }\n      } finally {\n        this.loading = false;\n      }\n    }\n  }\n};","map":{"version":3,"names":["data","order","oid","$route","query","total","parseFloat","loading","methods","handlePay","$axios","post","$httpUrl","code","$router","push","path","success","error","response","msg","includes","$message"],"sources":["src/user/PayPage.vue"],"sourcesContent":["<template>\r\n  <div class=\"pay-container\">\r\n    <el-steps :active=\"3\" simple class=\"steps\">\r\n      <el-step title=\"首页\" icon=\"el-icon-location-outline\" ></el-step>\r\n      <el-step title=\"确认订单\" icon=\"el-icon-goods\" style=\"margin-right: -20px\"></el-step>\r\n      <el-step title=\"支付\" icon=\"el-icon-wallet\" ></el-step>\r\n      <el-step title=\"完成\" icon=\"el-icon-success\"></el-step>\r\n    </el-steps>\r\n\r\n\r\n    <el-card class=\"pay-card\">\r\n      <div class=\"order-info\">\r\n        <h3>订单号：{{ order.oid }}</h3>\r\n        <p class=\"total\">支付金额：¥{{ order.total.toFixed(2) }}</p>\r\n      </div>\r\n\r\n      <div class=\"payment-methods\">\r\n        <el-radio-group>\r\n          <el-radio-button label=\"alipay\">\r\n            <img src=\"@/assets/alipay.jpg\" class=\"pay-icon\" alt=\"支付宝\">\r\n            <span class=\"pay-text\">支付宝</span>\r\n          </el-radio-button>\r\n          <el-radio-button label=\"wechat\">\r\n            <img src=\"@/assets/wechat-pay.jpg\" class=\"pay-icon\" alt=\"微信支付\">\r\n            <span class=\"pay-text\">微信支付</span>\r\n          </el-radio-button>\r\n        </el-radio-group>\r\n      </div>\r\n\r\n      <el-button\r\n          type=\"success\"\r\n          class=\"pay-btn\"\r\n          @click=\"handlePay\"\r\n          :loading=\"loading\">\r\n        立即支付\r\n      </el-button>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      order: {\r\n        oid: this.$route.query.oid,\r\n        total: parseFloat(this.$route.query.total)\r\n      },\r\n      loading: false\r\n    }\r\n  },\r\n  methods: {\r\n    async handlePay() {\r\n      this.loading = true\r\n      try {\r\n        const { data } = await this.$axios.post(this.$httpUrl+'/order/pay', {\r\n          oid: this.order.oid,\r\n        })\r\n\r\n        if (data.code === 200) {\r\n          this.$router.push({\r\n            path: '/pay-result',\r\n            query: {\r\n              success: true, oid: this.order.oid\r\n            }\r\n          })\r\n        }\r\n      } catch (error) {\r\n        // 新增库存不足的提示\r\n        if(error.response && error.response.data.msg.includes(\"库存不足\")) {\r\n          this.$message.error('部分商品库存不足，支付失败');\r\n        } else {\r\n          this.$message.error('支付失败');\r\n        }\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.pay-container {\r\n  max-width: 600px;\r\n  margin: 20px auto;\r\n  padding: 20px;\r\n}\r\n\r\n.steps {\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.pay-card {\r\n  padding: 20px;\r\n}\r\n\r\n.order-info {\r\n  text-align: center;\r\n  margin-bottom: 30px;\r\n}\r\n\r\n.order-info h3 {\r\n  color: #666;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.total {\r\n  font-size: 24px;\r\n  color: #f56c6c;\r\n  font-weight: bold;\r\n}\r\n\r\n.payment-methods {\r\n  margin: 30px 0;\r\n  text-align: center;\r\n}\r\n\r\n.pay-icon {\r\n  width: 100px;\r\n  vertical-align: middle;\r\n  margin-right: 10px;\r\n}\r\n\r\n.pay-btn {\r\n  width: 200px;\r\n  display: block;\r\n  margin: 0 auto;\r\n  height: 45px;\r\n  font-size: 16px;\r\n}\r\n\r\n.el-radio__original {\r\n  position: absolute !important;\r\n  width: 1px !important;\r\n  height: 1px !important;\r\n  padding: 0 !important;\r\n  margin: -1px !important;\r\n  overflow: hidden !important;\r\n  clip: rect(0,0,0,0) !important;\r\n  white-space: nowrap !important;\r\n  border: 0 !important;\r\n}\r\n.el-radio__original:focus {\r\n  outline: none !important;\r\n  box-shadow: none !important;\r\n}\r\n</style>"],"mappings":";AAyCA;EACAA,KAAA;IACA;MACAC,KAAA;QACAC,GAAA,OAAAC,MAAA,CAAAC,KAAA,CAAAF,GAAA;QACAG,KAAA,EAAAC,UAAA,MAAAH,MAAA,CAAAC,KAAA,CAAAC,KAAA;MACA;MACAE,OAAA;IACA;EACA;EACAC,OAAA;IACA,MAAAC,UAAA;MACA,KAAAF,OAAA;MACA;QACA;UAAAP;QAAA,eAAAU,MAAA,CAAAC,IAAA,MAAAC,QAAA;UACAV,GAAA,OAAAD,KAAA,CAAAC;QACA;QAEA,IAAAF,IAAA,CAAAa,IAAA;UACA,KAAAC,OAAA,CAAAC,IAAA;YACAC,IAAA;YACAZ,KAAA;cACAa,OAAA;cAAAf,GAAA,OAAAD,KAAA,CAAAC;YACA;UACA;QACA;MACA,SAAAgB,KAAA;QACA;QACA,IAAAA,KAAA,CAAAC,QAAA,IAAAD,KAAA,CAAAC,QAAA,CAAAnB,IAAA,CAAAoB,GAAA,CAAAC,QAAA;UACA,KAAAC,QAAA,CAAAJ,KAAA;QACA;UACA,KAAAI,QAAA,CAAAJ,KAAA;QACA;MACA;QACA,KAAAX,OAAA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}