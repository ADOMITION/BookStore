{"ast":null,"code":"export default {\n  data() {\n    return {\n      loading: false,\n      loginForm: {\n        no: '',\n        password: ''\n      },\n      rules: {\n        no: [{\n          required: true,\n          message: '账号不能为空',\n          trigger: 'blur'\n        }],\n        password: [{\n          required: true,\n          message: '密码不能为空',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  methods: {\n    async confirm() {\n      try {\n        this.loading = true;\n        await this.$refs.loginForm.validate();\n        const {\n          data: res\n        } = await this.$axios.post(this.$httpUrl + '/user/login', this.loginForm);\n        if (res.code !== 200) throw new Error(res.msg);\n        sessionStorage.setItem(\"CurUser\", JSON.stringify(res.data));\n        this.redirectByRole(res.data.roleId);\n        this.$message.success('登录成功');\n      } catch (err) {\n        this.$message.error('登录失败，,请检查用户名或密码');\n      } finally {\n        this.loading = false;\n      }\n    },\n    redirectByRole(roleId) {\n      // 优先使用 redirect 查询参数\n      const redirect = this.$route.query.redirect;\n      if (redirect) {\n        this.$router.replace(redirect);\n      } else {\n        // 根据角色跳转到默认页\n        const defaultPath = roleId === 0 ? '/admin' : '/';\n        this.$router.replace(defaultPath);\n      }\n    },\n    showForget() {\n      this.$message.info('请联系客服电话(1XXX00)重置密码');\n    }\n  }\n};","map":{"version":3,"names":["data","loading","loginForm","no","password","rules","required","message","trigger","methods","confirm","$refs","validate","res","$axios","post","$httpUrl","code","Error","msg","sessionStorage","setItem","JSON","stringify","redirectByRole","roleId","$message","success","err","error","redirect","$route","query","$router","replace","defaultPath","showForget","info"],"sources":["src/Login.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <div class=\"login-box\">\n      <div class=\"animated fadeIn\">\n        <h1 class=\"login-title\">书城阅读，知识之旅</h1>\n        <el-form\n            ref=\"loginForm\"\n            :model=\"loginForm\"\n            :rules=\"rules\"\n            status-icon\n            @keyup.enter.native=\"confirm\"\n        >\n          <el-form-item prop=\"no\">\n            <el-input\n                v-model=\"loginForm.no\"\n                prefix-icon=\"el-icon-user\"\n                placeholder=\"请输入账号\"\n                clearable\n            ></el-input>\n          </el-form-item>\n\n          <el-form-item prop=\"password\">\n            <el-input\n                v-model=\"loginForm.password\"\n                prefix-icon=\"el-icon-lock\"\n                placeholder=\"请输入密码\"\n                show-password\n                clearable\n            ></el-input>\n          </el-form-item>\n\n          <el-form-item>\n            <el-button\n                type=\"primary\"\n                @click=\"confirm\"\n                :loading=\"loading\"\n                class=\"submit-btn\"\n            >\n              登录\n            </el-button>\n          </el-form-item>\n\n          <div class=\"footer-links\">\n            <router-link to=\"/register\">立即注册</router-link>\n            <span>|</span>\n            <a @click=\"showForget\">忘记密码?</a>\n          </div>\n        </el-form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      loading: false,\n      loginForm: {\n        no: '',\n        password: ''\n      },\n      rules: {\n        no: [{ required: true, message: '账号不能为空', trigger: 'blur' }],\n        password: [\n          { required: true, message: '密码不能为空', trigger: 'blur' },\n        ]\n      }\n    }\n  },\n  methods: {\n    async confirm() {\n      try {\n        this.loading = true\n        await this.$refs.loginForm.validate()\n\n        const { data: res } = await this.$axios.post(this.$httpUrl+'/user/login', this.loginForm)\n        if (res.code !== 200) throw new Error(res.msg)\n\n        sessionStorage.setItem(\"CurUser\", JSON.stringify(res.data))\n        this.redirectByRole(res.data.roleId)\n        this.$message.success('登录成功')\n      } catch (err) {\n        this.$message.error('登录失败，,请检查用户名或密码')\n      } finally {\n        this.loading = false\n      }\n    },\n\n    redirectByRole(roleId) {\n      // 优先使用 redirect 查询参数\n      const redirect = this.$route.query.redirect\n      if (redirect) {\n        this.$router.replace(redirect)\n      } else {\n        // 根据角色跳转到默认页\n        const defaultPath = roleId === 0 ? '/admin' : '/'\n        this.$router.replace(defaultPath)\n      }\n    },\n\n    showForget() {\n      this.$message.info('请联系客服电话(1XXX00)重置密码')\n    }\n  }\n}\n</script>\n\n<style scoped>\n.login-container {\n  height: 100vh;\n  background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('@/assets/default-cover.jpg');\n  background-size: cover;\n  background-position: center;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.login-box {\n  width: 420px;\n  padding: 45px 40px;\n  background: rgba(255, 255, 255, 0.97);\n  border-radius: 15px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);\n  position: relative;\n  border: 1px solid rgba(255, 255, 255, 0.3);\n}\n\n.login-box::before {\n  content: '📖';\n  position: absolute;\n  top: -30px;\n  left: 50%;\n  transform: translateX(-50%);\n  font-size: 40px;\n  background: white;\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n.login-title {\n  text-align: center;\n  color: #2c3e50;\n  margin-bottom: 35px;\n  font-size: 28px;\n  font-weight: 600;\n  font-family: \"STXingkai\", \"华文行楷\", serif;\n}\n\n.submit-btn {\n  width: 100%;\n  height: 45px;\n  font-size: 16px;\n  font-weight: 500;\n  letter-spacing: 1px;\n  background: #8B4513;\n  border-color: #8B4513;\n  transition: all 0.3s ease;\n}\n\n.submit-btn:hover {\n  background: #A0522D;\n  border-color: #A0522D;\n  transform: translateY(-2px);\n}\n\n.footer-links {\n  text-align: center;\n  margin-top: 25px;\n  color: #666;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.footer-links a {\n  color: #8B4513;\n  margin: 0 10px;\n  cursor: pointer;\n  transition: all 0.3s;\n  text-decoration: none;\n  font-size: 14px;\n}\n\n.footer-links span {\n  color: #8B4513;\n  opacity: 0.6;\n}\n\n.footer-links a:hover {\n  color: #A0522D;\n  text-decoration: underline;\n}\n\n.animated {\n  animation-duration: 1s;\n}\n\n@keyframes fadeIn {\n  from { \n    opacity: 0; \n    transform: translateY(30px); \n  }\n  to { \n    opacity: 1; \n    transform: translateY(0); \n  }\n}\n\n:deep(.el-input__inner) {\n  height: 45px;\n  border-radius: 8px;\n  border: 1px solid #dcdfe6;\n  transition: all 0.3s;\n}\n\n:deep(.el-input__inner:focus) {\n  border-color: #8B4513;\n  box-shadow: 0 0 0 2px rgba(139, 69, 19, 0.1);\n}\n\n:deep(.el-input__prefix) {\n  left: 10px;\n}\n\n:deep(.el-form-item) {\n  margin-bottom: 25px;\n}\n\n:deep(.el-form-item:last-child) {\n  margin-bottom: 15px;\n}\n</style>"],"mappings":"AAsDA;EACAA,KAAA;IACA;MACAC,OAAA;MACAC,SAAA;QACAC,EAAA;QACAC,QAAA;MACA;MACAC,KAAA;QACAF,EAAA;UAAAG,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;QACAJ,QAAA,GACA;UAAAE,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA;MAEA;IACA;EACA;EACAC,OAAA;IACA,MAAAC,QAAA;MACA;QACA,KAAAT,OAAA;QACA,WAAAU,KAAA,CAAAT,SAAA,CAAAU,QAAA;QAEA;UAAAZ,IAAA,EAAAa;QAAA,eAAAC,MAAA,CAAAC,IAAA,MAAAC,QAAA,uBAAAd,SAAA;QACA,IAAAW,GAAA,CAAAI,IAAA,oBAAAC,KAAA,CAAAL,GAAA,CAAAM,GAAA;QAEAC,cAAA,CAAAC,OAAA,YAAAC,IAAA,CAAAC,SAAA,CAAAV,GAAA,CAAAb,IAAA;QACA,KAAAwB,cAAA,CAAAX,GAAA,CAAAb,IAAA,CAAAyB,MAAA;QACA,KAAAC,QAAA,CAAAC,OAAA;MACA,SAAAC,GAAA;QACA,KAAAF,QAAA,CAAAG,KAAA;MACA;QACA,KAAA5B,OAAA;MACA;IACA;IAEAuB,eAAAC,MAAA;MACA;MACA,MAAAK,QAAA,QAAAC,MAAA,CAAAC,KAAA,CAAAF,QAAA;MACA,IAAAA,QAAA;QACA,KAAAG,OAAA,CAAAC,OAAA,CAAAJ,QAAA;MACA;QACA;QACA,MAAAK,WAAA,GAAAV,MAAA;QACA,KAAAQ,OAAA,CAAAC,OAAA,CAAAC,WAAA;MACA;IACA;IAEAC,WAAA;MACA,KAAAV,QAAA,CAAAW,IAAA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}